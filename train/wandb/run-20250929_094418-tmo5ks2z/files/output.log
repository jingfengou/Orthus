[34m[1mwandb[0m: [33mWARNING[0m Serializing object of type dict that is 1922480 bytes
  0%|                                                                                                                                  | 0/3 [00:00<?, ?it/s]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.

======================================== [DEBUGGING AT GLOBAL STEP: 0] ========================================

--- [1. Ground Truth Labels] ---
Decoded Labels: [92m'C': 'Option C is correct because the relative positions of three faces match the cube shown in the left image.', 'B': 'Option B is incorrect because the squares with asymmetric patterns have been rotated.', 'D': 'Option D is incorrect because the squares with asymmetric patterns have been rotated.', 'A': 'Option A is incorrect because two faces have swapped positions.'} The final answer is <answer>C</answer>[0m
tensor(26.3750, device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<NllLossBackward0>)

--- [2. Model Prediction from Logits] ---
Decoded Prediction: [93m[0m

--- [3. Live Generation Output] ---
multimodal_generation_mode interleaved-text-image
multimodal_generation_mode image-only
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
[91mCould not generate output for debugging: 'NoneType' object has no attribute 'shape'[0m
===========================================================================================================
 33%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹                                                                                 | 1/3 [00:18<00:36, 18.43s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.

{'loss': 26.6719, 'grad_norm': 139.5934295654297, 'learning_rate': 3.3333333333333335e-05, 'epoch': 0.5}

======================================== [DEBUGGING AT GLOBAL STEP: 1] ========================================

--- [1. Ground Truth Labels] ---
Decoded Labels: [92m'C': 'Option C is correct because the squares with asymmetric patterns have been rotated, so it cannot form the cube shown in the left image.', 'B': 'Option B is incorrect because the relative positions of three faces match the cube shown in the left image.', 'A': 'Option A is incorrect because the relative positions of three faces match the cube shown in the left image.', 'D': 'Option D is incorrect because the relative positions of three faces match the cube shown in the left image.'} The final answer is <answer>C</answer>[0m
tensor(9.2500, device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<NllLossBackward0>)

--- [2. Model Prediction from Logits] ---
Decoded Prediction: [93m[0m

--- [3. Live Generation Output] ---
multimodal_generation_mode interleaved-text-image
multimodal_generation_mode image-only
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
[91mCould not generate output for debugging: 'NoneType' object has no attribute 'shape'[0m
===========================================================================================================
 67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–                                        | 2/3 [00:37<00:16, 16.64s/it]

{'loss': 9.0938, 'grad_norm': 107.46028137207031, 'learning_rate': 1.6666666666666667e-05, 'epoch': 1.0}
tensor(7.5655, device='cuda:0')
(tensor([[[-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         [-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         [-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         ...,
         [  6.4062,   8.5625,   9.9375,  ...,   2.5781,   6.2500,   6.1875],
         [  6.0312,   8.6875,  10.1875,  ...,   2.7031,   6.5000,   6.2500],
         [  5.9375,   8.8125,  10.3750,  ...,   3.5781,   7.1250,   6.5938]]],
       device='cuda:0'),)
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.                                                                                       
tensor(8.6055, device='cuda:0')
(tensor([[[-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         [-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         [-15.1875, -12.7500,  -5.4062,  ..., -14.6250,  -9.5625,  -7.6875],
         ...,
         [  6.3750,   8.5000,   9.6250,  ...,   2.7812,   6.0000,   5.6562],
         [  6.0625,   8.6250,   9.9375,  ...,   2.8750,   6.2188,   5.8438],
         [  5.7812,   8.8125,  10.3750,  ...,   3.7500,   6.8438,   6.1250]]],
       device='cuda:0'),)
{'eval_loss': 8.33372974395752, 'eval_runtime': 4.0012, 'eval_samples_per_second': 3.999, 'eval_steps_per_second': 0.5, 'epoch': 1.0}

======================================== [DEBUGGING AT GLOBAL STEP: 2] ========================================

--- [1. Ground Truth Labels] ---
Decoded Labels: [92m'C': 'Option C is incorrect because it is the cross-section of the shape made by a plane parallel to the XZ plane.', 'A': 'Option A is incorrect because it is the cross-section of the shape made by a plane parallel to the XY plane.', 'B': 'Option B is incorrect because it is the cross-section of the shape made by a plane parallel to the XZ plane.', 'D': 'Option D is correct because the corresponding cross-section does not match the shape shown in the reference image.'} The final answer is <answer>D</answer>[0m
tensor(8.9375, device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<NllLossBackward0>)

--- [2. Model Prediction from Logits] ---
Decoded Prediction: [93mØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡ØµÙØ­Ù‡[0m

--- [3. Live Generation Output] ---
multimodal_generation_mode interleaved-text-image
multimodal_generation_mode image-only
[91mCould not generate output for debugging: 'NoneType' object has no attribute 'shape'[0m
===========================================================================================================
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 3/3 [00:53<00:00, 17.74s/it]

{'loss': 8.3477, 'grad_norm': 260.55767822265625, 'learning_rate': 0.0, 'epoch': 1.5}
{'train_runtime': 55.3631, 'train_samples_per_second': 0.434, 'train_steps_per_second': 0.054, 'train_loss': 14.704427083333334, 'epoch': 1.5}


âœ… [Success] The SFT training pipeline test completed successfully!
This confirms that:
  - Data loading and preprocessing are correct.
  - The model's forward pass can compute a loss with your data.
  - The training and evaluation loops can run without crashing.
You are now ready for a full training run!
