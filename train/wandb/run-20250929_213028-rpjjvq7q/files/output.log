[34m[1mwandb[0m: [33mWARNING[0m Serializing object of type dict that is 1922480 bytes
  0%|                                                                                                                                | 0/118 [00:00<?, ?it/s]2025-09-29 21:30:31,374 - WARNING - `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.

======================================== [DEBUGGING AT GLOBAL STEP: 0] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'A': 'Option A is incorrect because it is a vertically mirrored version of the back-bottom-left view.', 'C': 'Option C is incorrect because it is a horizontally mirrored version of the front-top-right view.', 'ABCD': 'Assuming the bottom face is the first cell in the second row of the net, then after folding, the front face is cyan, the back face is red, the left face is green, the right face is blue, the top face is yellow, the bottom face is pink.', 'B': 'Option B is correct because it shows the back-bottom-right view.'} The final answer is <answer>B</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
Setting `pad_token_id` to `eos_token_id`:None for open-end generation.
/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/checkpoint.py:85: UserWarning: None of the inputs have requires_grad=True. Gradients will be None
  warnings.warn(
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  1%|█                                                                                                                       | 1/118 [00:19<37:29, 19.22s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 1] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'ABCD': 'The counterclockwise rotation of the green object drives the orange object to rotate clockwise, which in turn pulls the weight upward.'} The final answer is <answer>C</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  2%|██                                                                                                                      | 2/118 [00:33<31:22, 16.22s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 2] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'D': 'Option D is incorrect because it is the cross-section of the shape made by a plane parallel to the YZ plane.', 'B': 'Option B is incorrect because it is the cross-section of the shape made by a plane parallel to the XY plane.', 'A': 'Option A is incorrect because it is the cross-section of the shape made by a plane parallel to the YZ plane.', 'C': 'Option C is correct because the corresponding cross-section does not match the shape shown in the reference image.'} The final answer is <answer>C</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  3%|███                                                                                                                     | 3/118 [00:47<29:33, 15.42s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 3] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'D': 'Assuming the bottom face is the first cell in the second row of the net, and the right face is the cell to its right. Option D is correct because it shows the back-bottom-right view.', 'B': 'Assuming the bottom face is the first cell in the second row of the net, and the right face is the cell to its right. Option B is incorrect because it includes rotated non-symmetric faces.', 'C': 'Assuming the bottom face is the first cell in the second row of the net, and the right face is the cell to its right. Option C is incorrect because it includes rotated non-symmetric faces.', 'A': 'Assuming the bottom face is the first cell in the second row of the net, and the right face is the cell to its right. Option A is incorrect because it is a horizontally mirrored version of the back-top-left view.'} The final answer is <answer>D</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  3%|████                                                                                                                    | 4/118 [01:01<27:59, 14.73s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 4] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'C': 'Option C is correct because the initial arrow can be transformed into the final arrow.', 'BDA': 'Option BDA is incorrect because the initial arrow cannot be transformed into the final arrow.'} The final answer is <answer>C</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  4%|█████                                                                                                                   | 5/118 [01:16<28:09, 14.95s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 5] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'B': 'Option B is incorrect because holes in column 1 are missing.', 'A': 'Option A is incorrect because extra holes appear in column 2.', 'D': 'Option D is incorrect because holes that should appear in column 1 appear in column 2.'} The final answer is <answer>C</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  5%|██████                                                                                                                  | 6/118 [01:35<30:13, 16.19s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 6] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'ABCD': 'Given three views, at least 4 cubes and at most 4 cubes are required to satisfy the constraints.'} The final answer is <answer>D</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  6%|███████                                                                                                                 | 7/118 [01:49<28:49, 15.58s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 7] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'C': 'Option C is correct because it was obtained by rotating the original image 180 degrees.', 'A': 'Option A is incorrect because it was obtained by rotating the original image 180 degrees and then flipping it horizontally.', 'B': 'Option B is incorrect because it was obtained by rotating the original image 90 degrees and then flipping it vertically.'} The final answer is <answer>C</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
  7%|████████▏                                                                                                               | 8/118 [02:05<28:41, 15.65s/it]Setting `pad_token_id` to `eos_token_id`:None for open-end generation.


======================================== [DEBUGGING AT GLOBAL STEP: 8] (TRAIN) ========================================

--- [1. Ground Truth Labels] ---
  - Sample 0 Label: [92m'B': 'Option B is incorrect because one cube is missing, resulting in an incorrect cube stack shape.', 'C': 'Option C is incorrect because one cube is missing, resulting in an incorrect cube stack shape.'} The final answer is <answer>A</answer>[0m

--- [2. Model Prediction from Logits] ---
  - Sample 0 Pred: [93m[0m
===========================================================================================================


--- [3. Live Generation Output] ---
multimodal_generation_mode text-only
[91mCould not generate output for debugging: 'Tensor' object has no attribute 'logits'[0m
--- Full Traceback ---
Traceback (most recent call last):
  File "/data1/oujingfeng/project/twgi/Orthus/train/sft_orthus.py", line 260, in compute_loss
    generated_ids = self.model.generate(
                    ^^^^^^^^^^^^^^^^^^^^
  File "/data1/conda/envs/orthus/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/models/modeling_orthus_for_inteleave_cfg.py", line 2046, in generate
    return super().generate_cfg(
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 2290, in generate_cfg
    result = self._sample_orthus_cfg(
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data1/oujingfeng/project/twgi/Orthus/transformers/src/transformers/generation/utils.py", line 3974, in _sample_orthus_cfg
    next_token_logits = outputs.logits[:, -1, :].clone()
                        ^^^^^^^^^^^^^^
AttributeError: 'Tensor' object has no attribute 'logits'
----------------------
===========================================================================================================
